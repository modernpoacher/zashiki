"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});var _exportNames={get:true,post:true,pre:true,state:true,alpha:true,omega:true,embark:true,debark:true,confirm:true};exports.get=get;exports.post=post;Object.defineProperty(exports,"alpha",{enumerable:true,get:function get(){return _alpha2.default;}});Object.defineProperty(exports,"omega",{enumerable:true,get:function get(){return _omega2.default;}});Object.defineProperty(exports,"embark",{enumerable:true,get:function get(){return _embark2.default;}});Object.defineProperty(exports,"debark",{enumerable:true,get:function get(){return _debark2.default;}});Object.defineProperty(exports,"confirm",{enumerable:true,get:function get(){return _confirm2.default;}});exports.state=exports.pre=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator"));require("regenerator-runtime/runtime");var _asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));var _debug=_interopRequireDefault(require("debug"));var _stages=require("@modernpoacher/zashiki-transport/lib/stages");Object.keys(_stages).forEach(function(key){if(key==="default"||key==="__esModule")return;if(Object.prototype.hasOwnProperty.call(_exportNames,key))return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _stages[key];}});});var _exception=require("../common/exception");var _jid=_interopRequireDefault(require("../common/pre/jid"));var _rid=_interopRequireDefault(require("../common/pre/rid"));var _alpha2=_interopRequireDefault(require("./alpha"));var _omega2=_interopRequireDefault(require("./omega"));var _embark2=_interopRequireDefault(require("./embark"));var _debark2=_interopRequireDefault(require("./debark"));var _confirm2=_interopRequireDefault(require("./confirm"));var log=(0,_debug.default)('zashiki:stages');log('`stages` is awake');function get(_x){return _get.apply(this,arguments);}function _get(){_get=(0,_asyncToGenerator2.default)(_regenerator.default.mark(function _callee(_ref){var jid,_ref$params,resource;return _regenerator.default.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:jid=_ref.pre.jid,_ref$params=_ref.params,resource=_ref$params===void 0?{}:_ref$params;_context.prev=1;log({jid:jid,resource:resource});_context.next=5;return(0,_stages.change)({jid:jid,resource:resource});case 5:return _context.abrupt("return",(0,_stages.fetch)({jid:jid,resource:resource}));case 8:_context.prev=8;_context.t0=_context["catch"](1);(0,_exception.handleException)(_context.t0);case 11:case"end":return _context.stop();}}},_callee,null,[[1,8]]);}));return _get.apply(this,arguments);}function post(_x2){return _post.apply(this,arguments);}function _post(){_post=(0,_asyncToGenerator2.default)(_regenerator.default.mark(function _callee2(_ref2){var _ref2$pre,jid,response,_ref2$params,resource;return _regenerator.default.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_ref2$pre=_ref2.pre,jid=_ref2$pre.jid,response=_ref2$pre.response,_ref2$params=_ref2.params,resource=_ref2$params===void 0?{}:_ref2$params;_context2.prev=1;log({jid:jid,resource:resource});_context2.next=5;return(0,_stages.change)({jid:jid,resource:resource});case 5:return _context2.abrupt("return",(0,_stages.store)({jid:jid,resource:resource,response:response}));case 8:_context2.prev=8;_context2.t0=_context2["catch"](1);(0,_exception.handleException)(_context2.t0);case 11:case"end":return _context2.stop();}}},_callee2,null,[[1,8]]);}));return _post.apply(this,arguments);}var pre=[_jid.default,_rid.default];exports.pre=pre;var state={parse:true,failAction:'error'};exports.state=state;